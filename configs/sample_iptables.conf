# sample_iptables.conf
# Reference-only baseline rules for a lab router/firewall host.
# Apply with caution on a non-lab system.

*filter
:INPUT DROP [0:0]
:FORWARD DROP [0:0]
:OUTPUT ACCEPT [0:0]

# Allow loopback and established traffic
-A INPUT -i lo -j ACCEPT
-A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
-A FORWARD -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT

# Management (adjust CIDR for your lab)
-A INPUT -p tcp -s 10.10.10.0/24 --dport 22 -j ACCEPT

# Example forward policy: client -> server HTTP/DNS
-A FORWARD -s 10.10.10.0/24 -d 10.20.20.10/32 -p tcp --dport 80 -j ACCEPT
-A FORWARD -s 10.10.10.0/24 -d 10.20.20.10/32 -p udp --dport 53 -j ACCEPT
-A FORWARD -s 10.10.10.0/24 -d 10.20.20.10/32 -p tcp --dport 53 -j ACCEPT

COMMIT

*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [0:0]

# Example outbound NAT for client subnet leaving via eth0
-A POSTROUTING -s 10.10.10.0/24 -o eth0 -j MASQUERADE

# Example port forward 8080 -> internal web server:80
-A PREROUTING -i eth0 -p tcp --dport 8080 -j DNAT --to-destination 10.20.20.10:80

COMMIT
